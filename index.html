<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå¤å…±å’Œå›½ - OpenGeofictionåä½œå›½å®¶é¡¹ç›®</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root {
            --primary-color: #C8102E;
            --primary-dark: #9B0C23;
            --accent-color: #ffae00;
            --text-color: #2C3E50;
            --text-light: #5A6C7D;
            --light-bg: #F8F9FA;
            --white: #fffdfd;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 12px;
        }

        /* æ·±è‰²æ¨¡å¼å˜é‡è¦†ç›– */
        :root[data-theme="dark"] {
            --primary-color: #F97373;
            --primary-dark: #F05252;
            --accent-color: #FACC15;
            --text-color: #E5E7EB;
            --text-light: #9CA3AF;
            --light-bg: #0d182c;
            --white: #16303f;
            --shadow: 0 4px 18px rgba(0,0,0,0.7);
            --shadow-hover: 0 8px 30px rgba(0,0,0,0.9);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.7;
            color: var(--text-color);
            background-color: var(--light-bg);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* å¯¼èˆªæ  */
        header {
            background: var(--white);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: var(--transition);
        }
        
        header.scrolled {
            padding: 0.7rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            letter-spacing: -0.5px;
        }
        
        .logo span {
            color: var(--accent-color);
            margin-left: 6px;
            font-weight: 800;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.5rem;
            align-items: center;
        }
        
        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.95rem;
            position: relative;
        }
        
        .lang-switch {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-left: 1rem;
            white-space: nowrap;
        }

        .lang-switch span {
            margin: 0 0.25rem;
            color: #ccc;
        }

        .lang-switch a {
            font-weight: 600;
        }

        .lang-switch a.active-lang {
            color: var(--primary-color);
        }

        .lang-switch a::after {
            /* å»æ‰å¯¼èˆªä¸‹åˆ’çº¿åŠ¨ç”» */
            display: none;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: var(--transition);
        }
        
        .nav-links a:hover::after {
            width: 100%;
        }

        /* æ·±è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’® */
        .theme-toggle {
            border: none;
            background: rgba(148, 163, 184, 0.18);
            padding: 0.5rem 0.7rem;
            border-radius: 999px;
            cursor: pointer;
            margin-left: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .theme-toggle i {
            font-size: 1rem;
            color: var(--text-color);
        }

        .theme-toggle:hover {
            background: rgba(148, 163, 184, 0.35);
            transform: translateY(-1px);
        }
        
        .hamburger {
            display: none;
            cursor: pointer;
            flex-direction: column;
            justify-content: space-between;
            width: 28px;
            height: 22px;
        }
        
        .hamburger span {
            display: block;
            height: 3px;
            width: 100%;
            background: var(--primary-color);
            border-radius: 3px;
            transition: var(--transition);
        }
        
        /* ä¸»æ¨ªå¹… */
        .hero {
            background:
                linear-gradient(135deg, rgba(18, 26, 38, 0.92), rgba(200, 16, 46, 0.60)),
                url('https://images.unsplash.com/photo-1508804185872-d7badad00f7d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')
                no-repeat center center / cover;
            min-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #FFFFFF;
            position: relative;
            padding-top: 90px;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 30% 50%, rgba(255, 222, 0, 0.10), transparent 55%);
            pointer-events: none;
        }
        
        .hero-content {
            max-width: 900px;
            padding: 3rem 2rem;
            position: relative;
            z-index: 1;
        }
        
        .hero-tagline {
            font-size: 0.9rem;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            opacity: 0.85;
            margin-bottom: 0.5rem;
        }
        
        .hero-subtitle {
            font-size: 0.95rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }
        
        .hero h1 {
            font-size: clamp(2.6rem, 5.2vw, 3.6rem);
            margin-bottom: 1rem;
            font-weight: 800;
            letter-spacing: 2px;
            text-shadow: 1px 3px 6px rgba(0,0,0,0.35);
        }
        
        .hero p {
            font-size: clamp(1.05rem, 1.9vw, 1.3rem);
            margin-bottom: 2.2rem;
            line-height: 1.8;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            max-width: 720px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.95;
        }
        
        .btn {
            display: inline-block;
            background: var(--primary-color);
            color: #FFFFFF;
            padding: 1rem 2.5rem;
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 1.05rem;
            font-weight: 600;
            transition: var(--transition);
            margin: 0.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(200, 16, 46, 0.3);
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(200, 16, 46, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #FFFFFF;
            box-shadow: none;
        }
        
        .btn-outline:hover {
            background: #FFFFFF;
            color: var(--primary-color);
            border-color: #FFFFFF;
        }
        
        /* å†…å®¹åŒºåŸŸ */
        section {
            padding: 6rem 0;
        }
        
        section h2 {
            text-align: center;
            margin-bottom: 3rem;
            font-size: clamp(2rem, 4vw, 2.8rem);
            color: var(--primary-color);
            font-weight: 700;
            position: relative;
        }
        
        section h2::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* é¡¹ç›®ä»‹ç» - ä¸­è‹±æ–‡åˆ†æ  */
        .intro-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin-top: 2.5rem;
        }

        .intro-section {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem 2rem 2.2rem;
            position: relative;
            border-left: none;
            transition: var(--transition);
        }

        .intro-section:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .intro-section h3 {
            color: var(--text-color);
            font-size: 1.4rem;
            margin-bottom: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .intro-section h3::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary-color);
        }

        .intro-section p {
            margin-bottom: 1rem;
            font-size: 1.02rem;
            line-height: 1.9;
            color: var(--text-light);
        }

        
        /* OGF3Dåœ°å›¾é¢„è§ˆ */
        .ogf3d-map {
            background: var(--light-bg);
        }

        .map-intro {
            margin-top: -1rem;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            color: var(--text-light);
            text-align: center;
        }

        /* å¤–å£³ï¼šé™åˆ¶é«˜åº¦å’Œé˜´å½±ï¼Œä¸å…¨å± */
        .huaxia-map-viewer {
            position: relative;
            max-width: 2000px;
            height: 560px;
            margin: 0 auto 0;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 18px 45px rgba(0,0,0,0.16);
            background: var(--white);
        }

        /* Leaflet åœ°å›¾æœ¬ä½“å¡«æ»¡å¤–å£³ */
        #map {
            width: 100%;
            height: 100%;
            background: var(--white);
        }

        .leaflet-container {
            background: var(--white) !important;
        }

        :root[data-theme="dark"] .leaflet-container,
        :root[data-theme="dark"] #map {
            background: #020617 !important;
        }

        /* å³ä¸Šè§’æ§åˆ¶é¢æ¿ */
        #controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            min-width: 320px;
            max-height: calc(100% - 40px);
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        /* é¢æ¿å†…çš„â€œæ”¶èµ·â€æŒ‰é’® */
        .controls-collapse-btn {
            width: 100%;
            padding: 8px 10px;
            margin-bottom: 10px;
            border: none;
            border-radius: 6px;
            background: #e5e7eb;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            transition: background 0.2s, transform 0.2s;
        }

        .controls-collapse-btn:hover {
            background: #d1d5db;
            transform: translateY(-1px);
        }

        :root[data-theme="dark"] .controls-collapse-btn {
            background: #1f2937;
            color: var(--text-color);
        }

        :root[data-theme="dark"] .controls-collapse-btn:hover {
            background: #111827;
        }

        /* æ”¶èµ·æ—¶æ˜¾ç¤ºçš„æ‚¬æµ®â€œå±•å¼€â€æŒ‰é’® */
        .controls-expand-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1100;
            padding: 8px 14px;
            border-radius: 999px;
            border: none;
            background: rgba(15, 23, 42, 0.9);
            color: #f9fafb;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: none; /* é»˜è®¤ä¸æ˜¾ç¤ºï¼Œæ”¶èµ·æ—¶å†æ˜¾ç¤º */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
        }

        .controls-expand-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
        }

        :root[data-theme="light"] .controls-expand-btn {
            background: rgba(255, 255, 255, 0.95);
            color: #111827;
        }

        /* æ”¶èµ·åŠ¨ç”»ï¼šæŠŠå³ä¾§é¢æ¿æ•´ä½“æ»‘å‡ºè§†å£ */
        #controls {
            transition: transform 0.25s ease-out, opacity 0.25s ease-out;
        }

        .huaxia-map-viewer.controls-collapsed #controls {
            transform: translateX(110%);
            opacity: 0;
            pointer-events: none;
        }

        /* æ”¶èµ·çŠ¶æ€ä¸‹æ˜¾ç¤ºâ€œå±•å¼€â€æŒ‰é’® */
        .huaxia-map-viewer.controls-collapsed .controls-expand-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        /* å°å±å¹•æ—¶æŒ‰é’®ç•¥å¾®ä¸‹ç§»ä¸€ç‚¹ */
        @media (max-width: 768px) {
            .controls-expand-btn {
                top: 14px;
                right: 14px;
                font-size: 12px;
                padding: 7px 12px;
            }
        }

        :root[data-theme="dark"] #controls {
            background: rgba(65, 43, 43, 0.96);
            color: var(--text-color);
        }

        #controls h2 {
            margin: 0 0 15px 0;
            font-size: 18px;
            color: #333;
            border-bottom: 2px solid #4a9eff;
            padding-bottom: 10px;
        }

        :root[data-theme="dark"] #controls h2 {
            color: var(--text-color);
        }

        #controls h3 {
            margin: 15px 0 10px 0;
            font-size: 15px;
            color: #555;
            font-weight: 600;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        #controls button {
            width: 100%;
            padding: 12px;
            background: #4a9eff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-bottom: 8px;
        }

        #controls button:hover {
            background: #3a8eef;
        }

        #controls button:active {
            background: #2a7edf;
        }

        #controls button:last-child {
            margin-bottom: 0;
        }

        /* åº•éƒ¨ç¼©æ”¾ / åæ ‡ä¿¡æ¯æ¡ */
        #map-info {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 18px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            font-size: 13px;
            font-weight: 500;
            color: #333;
            display: flex;
            gap: 16px;
            white-space: nowrap;
        }

        :root[data-theme="dark"] #map-info {
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-color);
        }

        #map-info div {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        #map-info .label {
            color: #666;
            font-weight: 400;
        }

        #map-info .value {
            color: #4a9eff;
            font-weight: 600;
        }

        /* å›¾å±‚åˆ—è¡¨å’ŒæŒ‰é’® */
        .layer-list {
            background: #f9f9f9;
            border-radius: 6px;
            padding: 10px;
            margin-top: 8px;
            overflow-y: auto;
            touch-action: pan-y;
        }

        :root[data-theme="dark"] .layer-list {
            background: #3f1f1f;
        }

        .layer-item {
            background: #ffffff;
            border-radius: 6px;
            margin-bottom: 10px;
            padding: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s;
            touch-action: pan-y;
        }

        :root[data-theme="dark"] .layer-item {
            background: #3f1f1f;
            box-shadow: 0 1px 3px rgba(15, 23, 42, 0.8);
        }

        .layer-item:last-child {
            margin-bottom: 0;
        }

        .layer-item:hover {
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        .layer-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .layer-title {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .layer-title input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            margin-right: 10px;
        }

        .layer-title label {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            flex: 1;
        }

        :root[data-theme="dark"] .layer-title label {
            color: var(--text-color);
        }

        .layer-controls {
            display: flex;
            gap: 8px;
        }

        .layer-btn {
            background: #ebebeb;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: background 0.2s;
            padding: 0;
            margin: 0;
        }

        :root[data-theme="dark"] .layer-btn {
            background: #181f36;
            color: var(--text-color);
        }

        .layer-btn:hover,
        .layer-btn:active {
            background: #4e7388;
        }

        .layer-btn.delete {
            color: #ff4444;
        }

        .layer-settings {
            border-top: 1px solid #e0e0e0;
            padding-top: 10px;
            margin-top: 10px;
        }

        :root[data-theme="dark"] .layer-settings {
            border-top-color: #374151;
        }

        .layer-setting-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
            touch-action: none;
        }

        .layer-setting-row:last-child {
            margin-bottom: 0;
        }

        .layer-setting-row label {
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        :root[data-theme="dark"] .layer-setting-row label {
            color: var(--text-light);
        }

        .layer-setting-row input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .layer-setting-row .slider-group {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 180px;
            touch-action: pan-x;
        }

        .layer-setting-row input[type="range"] {
            flex: 1;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            outline: none;
            cursor: pointer;
            touch-action: pan-x;
        }

        .layer-setting-row input[type="range"]::-webkit-slider-thumb,
        .layer-setting-row input[type="range"]::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: #4a9eff;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .layer-setting-row .slider-value {
            font-size: 12px;
            color: #4a9eff;
            font-weight: 600;
            min-width: 38px;
            text-align: right;
        }

        .layer-empty {
            text-align: center;
            color: #999;
            font-size: 12px;
            padding: 20px;
        }

        .section-divider {
            height: 1px;
            background: #e0e0e0;
            margin: 15px 0;
        }

        :root[data-theme="dark"] .section-divider {
            background: #374151;
        }

        .add-layer-section {
            background: #f9f9f9;
            border-radius: 6px;
            padding: 12px;
            margin-top: 8px;
        }

        :root[data-theme="dark"] .add-layer-section {
            background: #3f1f1f;
        }

        .preset-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 8px;
        }

        .preset-btn {
            padding: 10px;
            background: #ffffff;
            border: 2px solid #e6e6e6;
            border-radius: 6px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0;
        }

        :root[data-theme="dark"] .preset-btn {
            background: #3f1f1f;
            border-color: #374151;
            color: var(--text-light);
        }

        .preset-btn:hover {
            border-color: #4a9eff;
            background: #f0f8ff;
        }

        :root[data-theme="dark"] .preset-btn:hover {
            background: #ffb0b0;
        }

        /* æ‹–æ‹½ç›¸å…³ */
        .layer-item.dragging {
            opacity: 0.5;
            cursor: move;
        }

        .layer-item.drag-over {
            border-top: 3px solid #4a9eff;
        }

        .drag-handle {
            cursor: move;
            color: #999;
            font-size: 18px;
            margin-right: 8px;
            user-select: none;
        }

        /* 3D é“¾æ¥åŒºåŸŸ */
        .map-extra-links {
            margin: 1.5rem auto 0;
            max-width: 1100px;
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            justify-content: flex-end;
            align-items: center;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .map-extra-links a {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
        }

        .map-extra-links a:hover {
            text-decoration: underline;
        }

        /* ç®€å•çš„å“åº”å¼æ”¶ç¼© */
        @media (max-width: 768px) {
            .huaxia-map-viewer {
                height: 420px;
                border-radius: 12px;
            }

            #controls {
                min-width: 260px;
                padding: 14px;
            }

            .theme-toggle {
                margin-left: 0.5rem;
            }

            #map-info {
                bottom: 10px;
                padding: 8px 14px;
                gap: 10px;
            }

            .map-extra-links {
                justify-content: center;
            }
        }

        .ogf-map-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .ogf-map-pane {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-hover);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .ogf-map-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem 0.5rem;
        }

        .ogf-map-header h3 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin: 0;
        }

        .ogf-map-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.1rem 0.5rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            background: var(--primary-color);
            color: #fff;
        }

        .ogf-map-iframe {
            width: 100%;
            height: 320px;
            border: none;
            display: block;
        }

        .ogf-map-pane .ogf-map-desc {
            padding: 1rem 1.5rem 1.3rem;
            background: var(--white);
        }

        .ogf-map-pane .ogf-map-desc p {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        /* å°å±å¹•ä¸‹æ”¹ä¸ºä¸Šä¸‹æ’åˆ— */
        @media (max-width: 968px) {
            .ogf-map-grid {
                grid-template-columns: 1fr;
            }

            .ogf-map-iframe {
                height: 280px;
            }
        }

        @media (max-width: 480px) {
            .container {
                width: 95%;
            }

            .hero-content {
                padding: 2rem 1rem;
            }

            .btn {
                padding: 0.8rem 1.8rem;
                font-size: 0.95rem;
            }

            .intro-section {
                padding: 1.5rem;
            }

            .ogf-map-iframe {
                height: 240px;
            }
        }
        
        .ogf-map-desc {
            padding: 2rem;
            text-align: center;
            background: var(--white);
        }
        
        .ogf-map-desc p {
            color: var(--text-light);
            font-size: 1rem;
            line-height: 1.7;
        }
        
        /* åŠŸèƒ½å¡ç‰‡ */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }
        
        .feature {
            background: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            padding: 3rem 2rem;
            opacity: 1;
        }
        
        .feature:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }
        
        .feature-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
        }
        
        .feature h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .feature p {
            color: var(--text-light);
            margin-bottom: 2rem;
            font-size: 1.05rem;
            line-height: 1.7;
        }
        
        /* åŠ å…¥æˆ‘ä»¬åŒºåŸŸ */
        #join {
            background: linear-gradient(135deg, #effcff 0%, #ffffff 100%);
        }

        :root[data-theme="dark"] #join {
            background: linear-gradient(135deg, #292141 0%, #10303a 100%);
        }
        
        .join-content {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .join-intro {
            text-align: center;
            font-size: 1.05rem;
            margin-bottom: 2.5rem;
            color: var(--text-light);
        }
        
        .join-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.05fr) minmax(0, 1.15fr);
            gap: 2rem;
            align-items: flex-start;
        }
        
        .join-card {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2.2rem 2rem;
        }
        
        .join-card h3 {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .join-card p {
            font-size: 0.98rem;
            color: var(--text-light);
            margin-bottom: 1rem;
        }
        
        /* æ­¥éª¤ 1 / 2 / 3 ç«–ç€æ’åˆ— */
        .join-steps {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            text-align: left;
            opacity: 1;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: #FFFFFF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(200, 16, 46, 0.3);
            flex-shrink: 0;
        }
        
        .step:hover .step-number {
            background: linear-gradient(135deg, var(--accent-color), #FFB700);
            color: var(--primary-color);
            transform: scale(1.08) rotate(4deg);
            box-shadow: 0 8px 20px rgba(255, 222, 0, 0.4);
        }
        
        .step h4 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 0.6rem;
            font-weight: 700;
        }
        
        .step p {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .join-cta {
            margin-top: 1.5rem;
            text-align: center;
        }
        
        .join-cta .btn {
            font-size: 1rem;
            padding: 0.9rem 2.4rem;
        }
        
        @media (max-width: 968px) {
            .intro-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .join-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--white);
                flex-direction: column;
                padding: 1.5rem 0;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                gap: 0;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .nav-links li {
                width: 100%;
                text-align: center;
            }
            
            .nav-links a {
                display: block;
                padding: 1rem;
            }
            
            .hamburger {
                display: flex;
            }
            
            .hamburger.active span:nth-child(1) {
                transform: rotate(45deg) translate(7px, 7px);
            }
            
            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }
            
            .hamburger.active span:nth-child(3) {
                transform: rotate(-45deg) translate(7px, -7px);
            }
            
            section {
                padding: 4rem 0;
            }
            
            .intro-section {
                padding: 2rem 1.5rem;
            }
            
            .features {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }
        
        /* é¡µè„š */
        footer {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #FFFFFF;
            padding: 4rem 0 2rem;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }
        
        .footer-section h3 {
            margin-bottom: 1.5rem;
            color: var(--accent-color);
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .footer-section a {
            color: #ddd;
            text-decoration: none;
            display: block;
            margin-bottom: 0.8rem;
            transition: var(--transition);
            font-size: 0.95rem;
        }
        
        .footer-section a:hover {
            color: var(--accent-color);
            padding-left: 5px;
        }
        
        .footer-section p {
            color: #bbb;
            margin-bottom: 1rem;
            line-height: 1.8;
        }
        
        .xiaohongshu-btn {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(135deg, #FF2442, #E61E3D);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(255, 36, 66, 0.4);
            margin-top: 1rem;
        }
        
        .xiaohongshu-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 36, 66, 0.5);
            background: linear-gradient(135deg, #E61E3D, #CC1A35);
        }
        
        .xiaohongshu-btn i {
            margin-right: 0.8rem;
            font-size: 1.2rem;
        }
        
        .qq-btn {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(135deg, #12b7f5, #168bff);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(22, 139, 255, 0.4);
            margin-top: 0.7rem;
        }

        .qq-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(22, 139, 255, 0.5);
            background: linear-gradient(135deg, #168bff, #0f76e0);
        }

        .qq-btn i {
            margin-right: 0.6rem;
            font-size: 1.1rem;
        }

        .copyright {
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: #aaa;
            text-align: center;
        }
        
        @media (max-width: 968px) {
            .footer-content {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

                /* åº•éƒ¨å…è´£å£°æ˜æ¡ */
        .disclaimer-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 2000;
            background: #111827;
            color: #e5e7eb;
            display: none; /* é»˜è®¤éšè—ï¼ŒJS å†³å®šä½•æ—¶æ˜¾ç¤º */
            padding: 0.9rem 1.2rem;
            box-shadow: 0 -4px 16px rgba(0, 0, 0, 0.35);
            font-size: 0.9rem;
        }

        :root[data-theme="dark"] .disclaimer-bar {
            background: #020617;
            color: #e5e7eb;
        }

        .disclaimer-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 1rem;
            justify-content: space-between;
        }

        .disclaimer-text {
            line-height: 1.6;
        }

        .disclaimer-text b {
            font-weight: 700;
        }

        .disclaimer-close-btn {
            padding: 0.45rem 1.2rem;
            border-radius: 999px;
            border: none;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            background: #facc15;
            color: #111827;
            transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
        }

        .disclaimer-close-btn:disabled {
            cursor: not-allowed;
            opacity: 0.65;
            box-shadow: none;
        }

        .disclaimer-close-btn:not(:disabled):hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.35);
            background: #fde047;
        }

        .disclaimer-bar.hide {
            transform: translateY(100%);
            opacity: 0;
            transition: transform 0.25s ease-out, opacity 0.25s ease-out;
        }

        @media (max-width: 640px) {
            .disclaimer-inner {
                flex-direction: column;
                align-items: flex-start;
            }

            .disclaimer-close-btn {
                align-self: stretch;
                text-align: center;
                width: 100%;
            }
        }

    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <header id="header">
        <div class="container">
            <nav>
                <div class="logo">OpenGeofiction <span>åå¤</span></div>
                <ul class="nav-links" id="navLinks">
                    <li><a href="#about">é¡¹ç›®ä»‹ç»</a></li>
                    <li><a href="#ogf3d-map">æµè§ˆåå¤</a></li>
                    <li><a href="#features">å…³äºåå¤</a></li>
                    <li><a href="#join">åŠ å…¥æˆ‘ä»¬</a></li>
                    <li class="lang-switch">
                        <a href="#" class="active-lang">ä¸­æ–‡</a>
                        <span>|</span>
                        <a href="huaxia-en.html">Original / EN</a>
                    </li>
                </ul>
                <button class="theme-toggle" id="themeToggle" aria-label="åˆ‡æ¢æ·±è‰²æ¨¡å¼">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <!-- ä¸»æ¨ªå¹… -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-tagline">OPEN GEOFICTION Â· HUAXIA COLLAB PROJECT</div>
            <div class="hero-subtitle">åœ¨è™šæ„å¤§é™†ä¸Šï¼Œé‡æ„ä¸€ä¸ªä¸œæ–¹æ–‡æ˜ä¸–ç•Œ</div>
            <h1>åå¤å…±å’Œå›½</h1>
            <p>
                æ¬¢è¿æ¥åˆ° OpenGeofiction ä¸­çš„ã€Œåå¤ã€å›½å®¶åä½œé¡¹ç›®ã€‚<br>
                è¿™é‡Œçš„æ¯ä¸€åº§åŸå¸‚ã€æ¯ä¸€æ¡é“è·¯ã€æ¯ä¸€ç‰‡å±±æµ·ï¼Œéƒ½æ˜¯ç”±å…¨çƒåˆ¶å›¾è€…å…±åŒå®Œæˆçš„å¼€æ”¾ä¸–ç•Œå®éªŒã€‚
            </p>
            <a href="#about" class="btn btn-outline">äº†è§£åå¤è®¾å®š</a>
            <a href="#join" class="btn">åŠ å…¥ OGF / ç”³è¯·åå¤</a>
        </div>
    </section>

    <!-- é¡¹ç›®ä»‹ç» -->
    <section id="about">
        <div class="container">
            <h2>é¡¹ç›®ä»‹ç»</h2>
            <div class="intro-grid">
                <!-- é¡¹ç›®ç®€ä»‹ -->
                <div class="intro-section">
                    <h3>é¡¹ç›®ç®€ä»‹</h3>
                    <p>åå¤å…±å’Œå›½æ˜¯ OpenGeofiction å¹³å°ä¸Šçš„åä½œåˆ¶å›¾å›½å®¶é¡¹ç›®ï¼Œä½äºè™šæ„å¤§é™†åŒ—å¡”æ´²ä¸­éƒ¨ä¸å—éƒ¨æ²¿æµ·åŒºåŸŸã€‚é¡¹ç›®æ—¨åœ¨é€šè¿‡å¤šäººåä½œçš„æ–¹å¼ï¼Œæ„å»ºä¸€ä¸ªå…·æœ‰ä¸œæ–¹æ–‡æ˜ç‰¹è‰²ã€åŒæ—¶ç¬¦åˆç°ä»£åŸå¸‚ä¸åœ°ç†é€»è¾‘çš„è™šæ„å›½å®¶ã€‚</p>

                    <p>ç›®å‰é¡¹ç›®é‡ç‚¹åŒ…æ‹¬ï¼šå›½å®¶æ•´ä½“ç©ºé—´ç»“æ„ã€ä¸»è¦åŸå¸‚ç¾¤ä¸äº¤é€šèµ°å»Šã€å±±å·æ²³æµç­‰è‡ªç„¶åœ°ç†æ ¼å±€ï¼Œä»¥åŠä¸å‘¨è¾¹è™šæ„å›½å®¶ä¹‹é—´çš„äº’åŠ¨å…³ç³»ã€‚å‚ä¸è€…å¯ä»¥åœ¨ç»Ÿä¸€è®¾å®šä¸‹ï¼Œå…±åŒå®Œå–„ä»å›½å®¶çº§è§„åˆ’åˆ°è¡—é“çº§ç»†èŠ‚ã€‚</p>

                    <p>æœ¬é¡µé¢ä¸ºåå¤é¡¹ç›®çš„ä¸­æ–‡ä»‹ç»ç‰ˆæœ¬ï¼Œæ–¹ä¾¿ä¸­æ–‡ç¤¾ç¾¤æˆå‘˜äº†è§£é¡¹ç›®èƒŒæ™¯ã€å‚ä¸æ–¹å¼ä¸åŸºç¡€è§„åˆ™ã€‚</p>
                </div>
                
                <!-- è®¾å®š -->
                <div class="intro-section">
                    <h3>ä¸–ç•Œè§‚ä¸å›½å®¶è®¾å®š</h3>
                    <p>åå¤å…±å’Œå›½ï¼ˆç®€ç§°ã€Œåå¤ã€ï¼‰åè½äºåŒ—å¡”æ´²ä¸­éƒ¨ä¸ä¸œå—éƒ¨æ²¿æµ·åœ°åŒºï¼Œå›½åœŸé¢ç§¯çº¦ 875,212 å¹³æ–¹åƒç±³ï¼ˆå«é¢†æµ·ï¼‰ã€‚å¢ƒå†…æ‹¥æœ‰å¤§åå²­ã€å¤©é—¨å±±ã€æ—æªå¤§å±±ç­‰å±±è„‰ä¸å¹¿é˜”å¹³åŸï¼ŒåŒ—éƒ¨æµ·å²¸çº¿ç›¸å¯¹å¹³ç›´ï¼Œå—éƒ¨æµ·å²¸çº¿æ›²æŠ˜å¤šå²›ï¼ŒåŒ…å«æ—¥å‡ºå²›ã€æ—¥è½å²›ã€ä¸œæµ·ç¾¤å²›ã€ä¸œæ–¹çº¢å²›ç­‰ã€‚</p>

                    <p>å†å²ä¸Šï¼Œåå¤æ›¾ä¸é‚»å›½ã€Œç™¾ã€æ„æˆç»Ÿä¸€æ”¿æƒï¼Œååœ¨å¤–æ¥æ®–æ°‘ä¸è¿‘ä»£æˆ˜äº‰çš„å†²å‡»ä¸‹é€æ­¥åˆ†ç¦»ã€‚ç°ä»£çš„åå¤ä¸ºå…±å’Œåˆ¶å›½å®¶ï¼Œå…·å¤‡è¾ƒä¸ºå®Œå–„çš„åŸºç¡€è®¾æ–½å’Œå·¥ä¸šä½“ç³»ï¼ŒåŒæ—¶å¤„äºæŒç»­åŸå¸‚åŒ–ä¸ç»æµå‘å±•çš„é˜¶æ®µã€‚</p>

                    <p>åå¤çš„æ•´ä½“ä¸–ç•Œè§‚å‚è€ƒäº†ç°å®ä¸œäºšåœ°åŒºçš„è‡ªç„¶åœ°ç†ã€ç¤¾ä¼šç»“æ„ä¸æ–‡åŒ–ç¬¦å·ï¼Œä½†å¹¶éä»»ä½•ç°å®å›½å®¶çš„ç®€å•å¤åˆ»ã€‚é¡¹ç›®é¼“åŠ±åœ¨ç»Ÿä¸€ä¸–ç•Œè§‚ä¸‹è¿›è¡Œåˆç†æƒ³è±¡ï¼ŒåŒ…æ‹¬ï¼šç°ä»£éƒ½å¸‚ã€ä¼ ç»Ÿèšè½ã€äº¤é€šç½‘ç»œã€å·¥ä¸šä¸æ¸¯å£ã€è‡ªç„¶ä¿æŠ¤åŒºç­‰å¤šå±‚çº§ç©ºé—´ã€‚</p>
                </div>
            </div>
        </div>
    </section>

    <!-- OGF3Dåœ°å›¾é¢„è§ˆ -->
    <section id="ogf3d-map" class="ogf3d-map">
        <div class="container">
            <h2>æµè§ˆåå¤</h2>

            <p class="map-intro">
                ä¸‹æ–¹ä¸ºåŸºäº Leaflet çš„ã€ŒOGF åå¤åœ°å›¾ã€æŸ¥çœ‹æ¨¡å—ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­è‡ªç”±ç¼©æ”¾ã€æ‹–åŠ¨è¿›è¡Œæµè§ˆã€‚
                è¯¥æ¨¡å—ä»…ç”¨äºæŸ¥çœ‹ç“¦ç‰‡åœ°å›¾ï¼Œä¸ä¼šä¿®æ”¹ OGF ä¸Šçš„ä»»ä½•å®é™…æ•°æ®ã€‚
            </p>

            <!-- åœ°å›¾æŸ¥çœ‹æ¨¡å— -->
            <div class="huaxia-map-viewer">
                <div id="map"></div>

                <!-- åº•éƒ¨å±…ä¸­ç¼©æ”¾ / åæ ‡ä¿¡æ¯ -->
                <div id="map-info">
                    <div><span class="label">ç¼©æ”¾:</span> <span class="value" id="zoom-level">6.0</span></div>
                    <div><span class="label">åæ ‡:</span> <span class="value" id="coordinates">15.00Â°, 150.00Â°</span></div>
                </div>

                <!-- å³ä¾§æ§åˆ¶é¢æ¿ï¼šå›¾å±‚åˆ—è¡¨ + é¢„è®¾å›¾å±‚ + é‡ç½® -->
                <div id="controls">
                    <h2>ğŸŒ OGF åå¤åœ°å›¾</h2>
                    <!-- æ”¶èµ·æŒ‰é’® -->
                    <button id="controlsCollapseBtn" class="controls-collapse-btn" type="button">
                        â®œ æ”¶èµ·é€‰é¡¹
                    </button>

                    <!-- å›¾å±‚ç®¡ç†æ¨¡å— -->
                    <h3>ğŸ—ºï¸ å›¾å±‚ç®¡ç†</h3>
                    <div class="control-group">
                        <div class="layer-list" id="layerList">
                            <div class="layer-empty">æ­£åœ¨åŠ è½½...</div>
                        </div>
                    </div>

                    <!-- æ·»åŠ å›¾å±‚ï¼ˆé¢„è®¾ï¼‰ -->
                    <div class="control-group">
                        <div class="add-layer-section">
                            <h3 style="font-size: 13px; color: #666; margin-bottom: 8px;">ğŸ“Œ é¢„è®¾å›¾å±‚</h3>
                            <div class="preset-grid" id="presetGrid">
                                <!-- é¢„è®¾æŒ‰é’®ç”±è„šæœ¬åŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="control-group">
                        <button id="resetBtn">ğŸ”„ é‡ç½®è§†å›¾</button>
                    </div>
                </div>
                <button id="controlsExpandBtn" class="controls-expand-btn" type="button">
                    ğŸ§­ æ‰“å¼€é€‰é¡¹
                </button>
            </div>

            <!-- 3Dï¼šåªä¿ç•™è¶…é“¾æ¥ -->
            <div class="map-extra-links">
                <span>æƒ³ä»¥ 3D è§†è§’æŸ¥çœ‹åå¤ï¼Ÿ</span>
                <a href="https://ogfvector.infinatio.us/#zoom=6&lat=32.5&lon=108.0"
                target="_blank" rel="noopener">
                    å‰å¾€ OGF 3D / çŸ¢é‡åœ°å›¾
                </a>
            </div>
        </div>
    </section>


    <!-- å…³äºåå¤ -->
    <section id="features">
        <div class="container">
            <h2>å…³äºåå¤</h2>
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">ğŸ—ºï¸</div>
                    <h3>ä¼˜ç§€ä½œå“</h3>
                    <p>æŸ¥çœ‹ç¤¾åŒºæˆå‘˜æœ€æ–°çš„åˆ›ä½œæˆæœï¼ŒåŒ…æ‹¬åŸå¸‚è§„åˆ’ã€äº¤é€šç½‘ç»œå’Œåœ°ç†ç‰¹å¾è®¾è®¡ã€‚</p>
                    <a href="#ogf3d-map" class="btn">æµè§ˆåœ°å›¾</a>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“–</div>
                    <h3>é¡¹ç›®Wiki</h3>
                    <p>æŸ¥çœ‹åå¤å…±å’Œå›½è®¾ç›¸å…³å®šé›†ï¼Œäº†è§£æˆ‘ä»¬çš„â€œå†å²â€ã€‚</p>
                    <a href="https://wiki.opengeofiction.net/index.php/Huaxia" class="btn">äº†è§£åå¤</a>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“</div>
                    <h3>ç»˜åˆ¶è§„åˆ™</h3>
                    <p>äº†è§£åå¤é¡¹ç›®çš„åˆ›ä½œæŒ‡å—å’Œè§„èŒƒï¼Œç¡®ä¿æ‚¨çš„ä½œå“ä¸æ•´ä½“ä¸–ç•Œè§‚ä¸€è‡´ã€‚</p>
                    <a href="https://wiki.opengeofiction.net/index.php/Collab:Huaxia" class="btn">æŸ¥çœ‹è§„åˆ™</a>
                </div>
            </div>
        </div>
    </section>

    <!-- åŠ å…¥æˆ‘ä»¬ï¼šåŠ å…¥ OGF ä¸–ç•Œ + ç”³è¯·åå¤ç¤¾åŒº -->
    <section id="join">
        <div class="container">
            <h2>åŠ å…¥æˆ‘ä»¬</h2>
            <div class="join-content">
                <p class="join-intro">
                    åŠ å…¥ OpenGeofiction ä¸–ç•Œæœ¬èº«æ˜¯å¼€æ”¾çš„ï¼Œä½†åŠ å…¥ã€Œåå¤åä½œç¤¾åŒºã€éœ€è¦ä¸€å®šä¸­æ–‡åŸºç¡€å’Œç®€å•å®¡æ ¸ã€‚
                    ä½ å¯ä»¥å…ˆè¿›å…¥ OGF ä¸–ç•Œç»ƒæ‰‹ï¼Œå†é€šè¿‡å³ä¾§è¡¨å•ç”³è¯·æˆä¸ºåå¤é¡¹ç›®æˆå‘˜ã€‚
                </p>

                <div class="join-grid">
                    <!-- åŠ å…¥ OGF ä¸–ç•Œ -->
                    <div class="join-card">
                        <h3>åŠ å…¥ OGF ä¸–ç•Œ / Join the OGF World</h3>
                        <p>
                            OGF æ˜¯ä¸€ä¸ªå®Œå…¨è™šæ„çš„åœ°å›¾ä¸–ç•Œï¼Œä½ å¯ä»¥åœ¨è“åŒºè‡ªç”±ç»ƒä¹ åŸå¸‚è§„åˆ’ã€äº¤é€šç½‘ç»œå’Œåœ°ç†ç»˜åˆ¶ï¼Œ
                            ä¹Ÿå¯ä»¥åœ¨æœªæ¥ç”³è¯·è®¤é¢†åä½œå›½å®¶æˆ–åœ°åŒºã€‚
                        </p>
                        <div class="join-steps">
                            <div class="step">
                                <div class="step-number">1</div>
                                <div class="step-text">
                                    <h4>æ³¨å†Œ OGF è´¦æˆ·</h4>
                                    <p>å‰å¾€ OpenGeofiction å®˜ç½‘æ³¨å†Œå…è´¹è´¦æˆ·ï¼Œç†Ÿæ‚‰ç¼–è¾‘å™¨ä¸åŸºç¡€æ“ä½œã€‚</p>
                                </div>
                            </div>
                            <div class="step">
                                <div class="step-number">2</div>
                                <div class="step-text">
                                    <h4>é˜…è¯»ä¸–ç•Œè§„åˆ™</h4>
                                    <p>é€šè¯» OGF å…¨ç«™è§„åˆ™ä¸å„ç±»è“åŒºæŒ‡å¯¼ï¼Œé¿å…ç ´åè®¾å®šæˆ–é€ æˆæŠ€æœ¯é—®é¢˜ã€‚</p>
                                </div>
                            </div>
                            <div class="step">
                                <div class="step-number">3</div>
                                <div class="step-text">
                                    <h4>ä»è“åŒºå¼€å§‹åˆ›ä½œ</h4>
                                    <p>åœ¨è“åŒºå…ˆå°è¯•ç»˜åˆ¶å°é•‡ã€é“è·¯ä¸åœ°å½¢ï¼Œç§¯ç´¯ç»éªŒåå†è€ƒè™‘åŠ å…¥åä½œé¡¹ç›®ã€‚</p>
                                </div>
                            </div>
                        </div>
                        <div class="join-cta">
                            <a href="https://opengeofiction.net" class="btn" target="_blank">å‰å¾€ OGF å®˜ç½‘</a>
                        </div>
                    </div>

                    <!-- ç”³è¯·åŠ å…¥åå¤ç¤¾åŒº -->
                    <div class="join-card">
                        <h3>ç”³è¯·åŠ å…¥åå¤åä½œç¤¾åŒºï¼ˆé‚®ä»¶ç”³è¯·ï¼‰</h3>
                        <p>
                            åå¤æ˜¯ä¸€ä¸ªç•¥æœ‰é™åˆ¶çš„åˆä½œé¡¹ç›®ï¼›
                            æˆ‘ä»¬å¸Œæœ›é€šè¿‡ä½ çš„ä½œå“ï¼Œæ›´å¥½åœ°äº†è§£ä½ çš„é£æ ¼å’Œå¯¹ä¸–ç•Œè§‚çš„ç†è§£ã€‚
                        </p>
                        <p>
                            æ¨èä½ å…·å¤‡ä¸€å®šçš„ä¸­æ–‡é˜…è¯»èƒ½åŠ›ï¼Œå¹¶å¯¹ OpenGeofiction çš„åŸºæœ¬è§„åˆ™å’Œç»˜å›¾è§„èŒƒæœ‰åˆæ­¥äº†è§£ã€‚
                            è‹¥ä½ è¿˜æœªåœ¨ OGF ä¸Šåˆ›ä½œè¿‡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–å½¢å¼çš„ä½œå“å±•ç¤ºä½ çš„ç©ºé—´æ„Ÿä¸è®¾å®šèƒ½åŠ›ã€‚
                        </p>

                        <h4 style="margin-top: 1.2rem; font-size: 1rem; color: var(--primary-color);">ä¸€ã€ä½œå“é›†å†…å®¹å»ºè®®åŒ…æ‹¬</h4>
                        <ul style="margin: 0.4rem 0 0.8rem 1.2rem; padding-left: 0;">
                            <li>1ï½3 ä»½ä»£è¡¨æ€§ä½œå“ï¼ˆä»»é€‰å…¶ä¸€æˆ–æ··åˆï¼‰ï¼š</li>
                            <li>Â· æ‰‹ç»˜åœ°å›¾ / åŸå¸‚è‰å›¾ / åŒºåŸŸè§„åˆ’è‰å›¾</li>
                            <li>Â· åŸå¸‚å»ºè®¾ç±»æ¸¸æˆä¸­çš„å­˜æ¡£æˆ–æˆªå›¾ï¼ˆå¦‚ã€ŠCities: Skylinesã€‹ç­‰ï¼‰ï¼Œé™„ç®€å•æ–‡å­—è¯´æ˜</li>
                            <li>Â· æ¶ç©ºä¸–ç•Œ / æ¶ç©ºå›½å®¶ / æ¶ç©ºåŸå¸‚ç­‰ç›¸å…³è®¾å®šæ–‡æ¡£ã€Wiki è‰ç¨¿æˆ–ç¤ºæ„å›¾</li>
                            <li>Â· è‹¥å·²åœ¨ OGF ç»˜å›¾ï¼Œå¯é™„ä¸Šç›¸å…³åæ ‡é“¾æ¥æˆ–é¡µé¢é“¾æ¥</li>
                        </ul>

                        <h4 style="margin-top: 0.8rem; font-size: 1rem; color: var(--primary-color);">äºŒã€é‚®ä»¶ä¸­è¯·ç®€å•ä»‹ç»</h4>
                        <ul style="margin: 0.4rem 0 0.8rem 1.2rem; padding-left: 0;">
                            <li>Â· ä½ çš„å¸¸ç”¨æ˜µç§° / OGF ç”¨æˆ·åï¼ˆå¦‚æœ‰ï¼‰</li>
                            <li>Â· ä¸»è¦ä½¿ç”¨è¯­è¨€ï¼ˆä¸­æ–‡ / è‹±æ–‡ / å…¶ä»–ï¼‰</li>
                            <li>Â· å¸Œæœ›åœ¨åå¤å‚ä¸çš„æ–¹å‘ï¼ˆä¾‹å¦‚ï¼šé“è·¯ã€é«˜é€Ÿå…¬è·¯ã€åŸå¸‚æ€»ä½“è§„åˆ’ã€åœ°æ–¹å°é•‡ã€è‡ªç„¶åœ°ç†ç­‰ï¼‰</li>
                            <li>Â· å¯¹åå¤æˆ–ç›¸å…³åŒºåŸŸçš„ç®€è¦æ„æƒ³ï¼ˆå¯é€‰ï¼‰</li>
                        </ul>

                        <h4 style="margin-top: 0.8rem; font-size: 1rem; color: var(--primary-color);">ä¸‰ã€å‘é€åˆ°åä½œé‚®ç®±</h4>
                        <p class="email-note">
                            è¯·å°†ä¸Šè¿°å†…å®¹æ•´ç†åå‘é€è‡³åä½œé‚®ç®±
                            ã€2543969386@qq.comã€ï¼Œ
                            é‚®ä»¶æ ‡é¢˜å»ºè®®æ ¼å¼ï¼š
                            <code>ã€åå¤ç”³è¯·ã€‘ä½ çš„æ˜µç§° / OGF ç”¨æˆ·å</code>ã€‚
                        </p>
                        <p class="email-note">
                            åä½œå›¢é˜Ÿä¼šåœ¨æœ‰ç©ºæ—¶é›†ä¸­å¤„ç†ç”³è¯·ï¼Œå¹¶é€šè¿‡é‚®ä»¶æˆ– OGF ç«™å†…ä¿¡è¿›è¡Œå›å¤ã€‚ç”±äºæˆå‘˜å‡ä¸ºå¿—æ„¿è€…ï¼Œå›å¤æ—¶é—´å¯èƒ½ç•¥æœ‰æ³¢åŠ¨ï¼Œè¿˜è¯·ç†è§£ä¸è€å¿ƒç­‰å¾…ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- é¡µè„š -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <!-- å…³äºé¡¹ç›® -->
                <div class="footer-section">
                    <h3>å…³äºé¡¹ç›®</h3>
                    <p>åå¤å…±å’Œå›½æ˜¯ OpenGeofiction å¹³å°ä¸Šçš„åä½œåˆ¶å›¾é¡¹ç›®ï¼Œè‡´åŠ›äºæ„å»ºä¸€ä¸ªçœŸå®ã€è¯¦ç»†çš„è™šæ„ä¸œæ–¹æ–‡æ˜å›½å®¶ã€‚</p>
                    <a href="contributors.html">è´¡çŒ®è€…åå•</a>
                    <a href="#about">é¡¹ç›®å†å²</a>
                </div>
                
                <!-- å¿«é€Ÿé“¾æ¥ -->
                <div class="footer-section">
                    <h3>å¿«é€Ÿé“¾æ¥</h3>
                    <a href="#about">é¡¹ç›®ä»‹ç»</a>
                    <a href="#ogf3d-map">æµè§ˆåå¤</a>
                    <a href="#features">å…³äºåå¤</a>
                    <a href="#join">åŠ å…¥æˆ‘ä»¬</a>
                    <a href="https://opengeofiction.net" target="_blank">OGFå®˜ç½‘</a>
                </div>
                
                <!-- èµ„æºä¸ç¤¾åŒº -->
                <div class="footer-section">
                    <h3>èµ„æºä¸ç¤¾åŒº</h3>
                    <a href="/index.php/Collab:Huaxia/Guide">ç»˜åˆ¶æ•™ç¨‹ / åå¤ç»˜å›¾æŒ‡å—</a>
                    <a href="#styleguide">é£æ ¼æŒ‡å—ï¼ˆé¢„ç•™ï¼‰</a>
                    <a href="#forum">é¡¹ç›®è®ºå›ï¼ˆé¢„ç•™ï¼‰</a>
                    <a href="#help">æ–°æ‰‹æŒ‡å¯¼ï¼ˆé¢„ç•™ï¼‰</a>
                    <a href="https://www.xiaohongshu.com/user/profile/6754331e0000000016009ad4" class="xiaohongshu-btn" target="_blank">
                        <i class="fas fa-book"></i> å…³æ³¨å°çº¢ä¹¦ Â· åå¤é¡¹ç›®
                    </a>
                    <a href="https://qun.qq.com/universal-share/share?ac=1&authKey=RWkRJkUPR4v4Sp9T0qATDPywjyyimawQR2q3PBnIAofN0U86EY4rXzBuPN8t2voh&busi_data=eyJncm91cENvZGUiOiI5ODM5MTQ2OTQiLCJ0b2tlbiI6ImJzRlFrMzJkNzZEREtOVldpblgxT3hPbmhIOE1ISEVEd0JxRGcvektQZTRjSGZ3THBQRXhHWTI5aXRjRGQvbTUiLCJ1aW4iOiIxMDIwNDQxOTgzIn0%3D&data=5G_KYP-l6lPTsFSohnfUPzT21zZ-nk1r5mzk3we1MTe2Mas4jyj-QcF7pB0D3jych-2_reU_aHgtybUYAS39Qw&svctype=4&tempid=h5_group_info" class="qq-btn" target="_blank">
                        <i class="fab fa-qq"></i> åŠ å…¥QQç¾¤ Â· åå¤é¡¹ç›®
                    </a>
                </div>
            </div>
            
            <!-- ç‰ˆæƒä¿¡æ¯ -->
            <div class="copyright">
                <p>&copy; 2023â€“2025 OpenGeofiction åå¤åä½œå›½å®¶é¡¹ç›®. æœ¬é¡µé¢å†…å®¹åŸºäº CC BY-SA 4.0 è®¸å¯å…±äº«.</p>
            </div>
        </div>
    </footer>

        <!-- åº•éƒ¨å…è´£å£°æ˜æ¡ -->
    <div id="disclaimerBar" class="disclaimer-bar" role="status" aria-live="polite">
        <div class="disclaimer-inner">
            <div class="disclaimer-text">
                <b>å…è´£å£°æ˜ï¼š</b>
                æœ¬é¡µé¢æ‰€è¿°â€œåå¤å…±å’Œå›½â€ã€åŒ—å¡”æ´²ç­‰å†…å®¹å‡ä¸º OpenGeofiction è™šæ„ä¸–ç•Œçš„ä¸€éƒ¨åˆ†ï¼Œ
                ä¸ä»»ä½•ç°å®å›½å®¶ã€åœ°åŒºã€äººç‰©ã€äº‹ä»¶æ— å…³ï¼Œä»…ä¾›ä¸–ç•Œè§‚ä¸åœ°å›¾åˆ›ä½œçˆ±å¥½è€…å¨±ä¹ä¸äº¤æµä¹‹ç”¨ã€‚
            </div>
            <button type="button" class="disclaimer-close-btn">
                ï¼ˆ<span data-countdown>3</span> ç§’åå¯å…³é—­ï¼‰
            </button>
        </div>
    </div>

    <script>
        // ä¸»é¢˜åˆ‡æ¢
        (function () {
            const root = document.documentElement;
            const toggleBtn = document.getElementById('themeToggle');
            const THEME_KEY = 'huaxia-theme';

            function applyTheme(theme) {
                root.setAttribute('data-theme', theme);
                if (toggleBtn) {
                    toggleBtn.innerHTML = theme === 'dark'
                        ? '<i class="fas fa-sun"></i>'
                        : '<i class="fas fa-moon"></i>';
                }
            }

            const stored = localStorage.getItem(THEME_KEY);
            if (stored === 'dark' || stored === 'light') {
                applyTheme(stored);
            } else {
                applyTheme('light');
            }

            if (toggleBtn) {
                toggleBtn.addEventListener('click', function () {
                    const current = root.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
                    const next = current === 'dark' ? 'light' : 'dark';
                    applyTheme(next);
                    localStorage.setItem(THEME_KEY, next);
                });
            }
        })();

        // å¯¼èˆªæ æ»šåŠ¨æ•ˆæœ
        window.addEventListener('scroll', function() {
            const header = document.getElementById('header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
        document.getElementById('hamburger').addEventListener('click', function() {
            document.getElementById('navLinks').classList.toggle('active');
            this.classList.toggle('active');
        });

        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    e.preventDefault();
                    const headerHeight = document.getElementById('header').offsetHeight;
                    const targetPosition = targetElement.offsetTop - headerHeight;
                    
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                    
                    // ç§»åŠ¨ç«¯å…³é—­èœå•
                    if (window.innerWidth <= 768) {
                        document.getElementById('navLinks').classList.remove('active');
                        document.getElementById('hamburger').classList.remove('active');
                    }
                }
            });
        });
    </script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // å¦‚æœæœ¬é¡µæ²¡æœ‰ mapï¼ˆæ¯”å¦‚è‹±æ–‡ç‰ˆï¼‰ï¼Œç›´æ¥è·³è¿‡
        if (!document.getElementById('map') || typeof L === 'undefined') return;

        // ===== é…ç½®é¡¹ =====
        const CONFIG = {
            presetLayers: {
                'ogf-carto': {
                    name: 'OGF Carto',
                    url: 'https://tile.opengeofiction.net/ogf-carto/{z}/{x}/{y}.png',
                    attribution: 'Â© OpenGeoFiction contributors',
                    maxZoom: 18
                },
                'osm': {
                    name: 'OSM Carto',
                    url: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png',
                    attribution: 'Â© OpenStreetMap contributors',
                    maxZoom: 18
                }
            },
            defaultView: {
                center: [15, 150],   // å¯ä»¥æ”¹æˆåå¤å¤§è‡´ä¸­å¿ƒ
                zoom: 6
            }
        };

        // ===== åˆå§‹åŒ–åœ°å›¾ =====
        const map = L.map('map', {
            center: CONFIG.defaultView.center,
            zoom: CONFIG.defaultView.zoom,
            zoomControl: true,
            worldCopyJump: true,
            maxBounds: [[-90, -180], [90, 180]],
            maxBoundsViscosity: 0.5
        });

        // å·¦ä¸‹è§’æ¯”ä¾‹å°º
        L.control.scale({
            position: 'bottomleft',
            metric: true,
            imperial: false,
            maxWidth: 150
        }).addTo(map);

        // ===== å›¾å±‚ç®¡ç†å™¨ =====
        class LayerManager {
            constructor(map, config) {
                this.map = map;
                this.config = config;
                this.layers = [];
                this.nextId = 1;
                this.createLayerPanes();
            }

            createLayerPanes() {
                for (let i = 0; i < 20; i++) {
                    this.map.createPane(`layer-pane-${i}`);
                    this.map.getPane(`layer-pane-${i}`).style.zIndex = 200 + i * 10;
                }
            }

            addLayer(presetKey, config = {}) {
                const presetConfig = this.config.presetLayers[presetKey];
                if (!presetConfig) {
                    console.error(`Preset layer ${presetKey} not found`);
                    return null;
                }

                const layerId = this.nextId++;
                const layerIndex = this.layers.length;

                const layerData = {
                    id: layerId,
                    presetKey,
                    name: presetConfig.name,
                    visible: true,
                    opacity: config.opacity !== undefined ? config.opacity : 1.0,
                    grayscale: config.grayscale !== undefined ? config.grayscale : false,
                    layer: null,
                    pane: `layer-pane-${layerIndex}`
                };

                layerData.layer = L.tileLayer(presetConfig.url, {
                    attribution: presetConfig.attribution,
                    maxZoom: presetConfig.maxZoom,
                    opacity: layerData.opacity,
                    pane: layerData.pane
                });

                layerData.layer.addTo(this.map);
                this.applyGrayscaleFilter(layerData);

                this.layers.push(layerData);
                return layerData;
            }

            removeLayer(layerId) {
                const index = this.layers.findIndex(l => l.id === layerId);
                if (index === -1) return false;

                const layerData = this.layers[index];
                this.map.removeLayer(layerData.layer);
                this.layers.splice(index, 1);

                this.reorderLayers();
                return true;
            }

            moveLayer(layerId, direction) {
                const index = this.layers.findIndex(l => l.id === layerId);
                if (index === -1) return false;

                const newIndex = direction === 'up' ? index + 1 : index - 1;
                if (newIndex < 0 || newIndex >= this.layers.length) return false;

                [this.layers[index], this.layers[newIndex]] = [this.layers[newIndex], this.layers[index]];
                this.reorderLayers();
                return true;
            }

            reorderLayers() {
                this.layers.forEach((layerData, index) => {
                    const newPane = `layer-pane-${index}`;
                    layerData.pane = newPane;

                    const presetConfig = this.config.presetLayers[layerData.presetKey];
                    this.map.removeLayer(layerData.layer);

                    layerData.layer = L.tileLayer(presetConfig.url, {
                        attribution: presetConfig.attribution,
                        maxZoom: presetConfig.maxZoom,
                        opacity: layerData.opacity,
                        pane: newPane
                    });

                    if (layerData.visible) {
                        layerData.layer.addTo(this.map);
                    }

                    this.applyGrayscaleFilter(layerData);
                });
            }

            toggleLayer(layerId, visible) {
                const layerData = this.layers.find(l => l.id === layerId);
                if (!layerData) return false;

                layerData.visible = visible;
                if (visible) {
                    layerData.layer.addTo(this.map);
                } else {
                    this.map.removeLayer(layerData.layer);
                }
                return true;
            }

            setOpacity(layerId, opacity) {
                const layerData = this.layers.find(l => l.id === layerId);
                if (!layerData) return false;

                layerData.opacity = opacity;
                layerData.layer.setOpacity(opacity);
                return true;
            }

            toggleGrayscale(layerId, enabled) {
                const layerData = this.layers.find(l => l.id === layerId);
                if (!layerData) return false;

                layerData.grayscale = enabled;
                this.applyGrayscaleFilter(layerData);
                return true;
            }

            applyGrayscaleFilter(layerData) {
                const pane = this.map.getPane(layerData.pane);
                if (layerData.grayscale) {
                    pane.style.filter = 'grayscale(100%)';
                } else {
                    pane.style.filter = 'none';
                }
            }

            getAllLayers() {
                return this.layers;
            }

            reset() {
                this.map.setView(CONFIG.defaultView.center, CONFIG.defaultView.zoom);
            }
        }

        const layerManager = new LayerManager(map, CONFIG);
        // é»˜è®¤ä½¿ç”¨å½©è‰²å›¾å±‚ï¼ˆä¸å†æ˜¯é»‘ç™½ï¼‰
        layerManager.addLayer('ogf-carto', { grayscale: false });

        // ===== UI ç®¡ç† =====
        const layerList = document.getElementById('layerList');
        const presetGrid = document.getElementById('presetGrid');
        const resetBtn = document.getElementById('resetBtn');

        function renderLayerList() {
            const layers = layerManager.getAllLayers();

            if (layers.length === 0) {
                layerList.innerHTML = '<div class="layer-empty">æš‚æ— å›¾å±‚ï¼Œè¯·æ·»åŠ é¢„è®¾å›¾å±‚</div>';
                return;
            }

            layerList.innerHTML = '';

            [...layers].reverse().forEach((layerData, reverseIndex) => {
                const actualIndex = layers.length - 1 - reverseIndex;
                const item = document.createElement('div');
                item.className = 'layer-item';
                item.dataset.layerId = layerData.id;

                item.innerHTML = `
                    <div class="layer-header">
                        <div class="layer-title">
                            <span class="drag-handle" draggable="true">â‹®â‹®</span>
                            <input type="checkbox" id="layer-visible-${layerData.id}" ${layerData.visible ? 'checked' : ''}>
                            <label for="layer-visible-${layerData.id}">${layerData.name}</label>
                        </div>
                        <div class="layer-controls">
                            ${actualIndex < layers.length - 1 ? '<button class="layer-btn" data-action="up">â–²</button>' : ''}
                            ${actualIndex > 0 ? '<button class="layer-btn" data-action="down">â–¼</button>' : ''}
                            <button class="layer-btn delete" data-action="delete">âœ•</button>
                        </div>
                    </div>
                    <div class="layer-settings">
                        <div class="layer-setting-row">
                            <label>
                                <input type="checkbox" data-setting="grayscale" ${layerData.grayscale ? 'checked' : ''}>
                                ğŸ¨ é»‘ç™½æ¨¡å¼
                            </label>
                        </div>
                        <div class="layer-setting-row">
                            <label style="font-size: 12px; color: #666;">ä¸é€æ˜åº¦</label>
                            <div class="slider-group">
                                <input type="range" data-setting="opacity" min="0" max="100" value="${layerData.opacity * 100}">
                                <span class="slider-value">${Math.round(layerData.opacity * 100)}%</span>
                            </div>
                        </div>
                    </div>
                `;

                // å¯è§æ€§ / é»‘ç™½ / é€æ˜åº¦
                const checkbox = item.querySelector('input[type="checkbox"]:not([data-setting])');
                checkbox.addEventListener('change', (e) => {
                    layerManager.toggleLayer(layerData.id, e.target.checked);
                });

                const grayscaleCheckbox = item.querySelector('[data-setting="grayscale"]');
                grayscaleCheckbox.addEventListener('change', (e) => {
                    layerManager.toggleGrayscale(layerData.id, e.target.checked);
                });

                const opacitySlider = item.querySelector('[data-setting="opacity"]');
                const opacityValue = item.querySelector('.slider-value');
                opacitySlider.addEventListener('input', (e) => {
                    const value = e.target.value / 100;
                    layerManager.setOpacity(layerData.id, value);
                    opacityValue.textContent = e.target.value + '%';
                });

                // é˜»æ­¢æ»‘å—åŒºåŸŸè§¦å‘æ‹–æ‹½
                const sliderGroup = opacitySlider.closest('.slider-group');
                sliderGroup.addEventListener('mousedown', (e) => {
                    e.stopPropagation();
                });
                sliderGroup.addEventListener('touchstart', (e) => {
                    e.stopPropagation();
                }, { passive: false });

                // ä¸Šç§» / ä¸‹ç§» / åˆ é™¤
                item.querySelectorAll('.layer-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const action = btn.dataset.action;

                        if (action === 'delete') {
                            if (confirm(`ç¡®å®šè¦åˆ é™¤å›¾å±‚"${layerData.name}"å—ï¼Ÿ`)) {
                                layerManager.removeLayer(layerData.id);
                                renderLayerList();
                            }
                        } else if (action === 'up' || action === 'down') {
                            layerManager.moveLayer(layerData.id, action);
                            renderLayerList();
                        }
                    });
                });

                // æ‹–æ‹½æ’åº
                const dragHandle = item.querySelector('.drag-handle');

                dragHandle.addEventListener('dragstart', (e) => {
                    e.stopPropagation();
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', layerData.id.toString());
                    setTimeout(() => {
                        item.classList.add('dragging');
                    }, 0);
                });

                dragHandle.addEventListener('dragend', () => {
                    item.classList.remove('dragging');
                });

                item.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                });

                item.addEventListener('drop', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    const draggedId = parseInt(e.dataTransfer.getData('text/plain'));
                    const targetId = layerData.id;

                    if (draggedId !== targetId) {
                        const layers = layerManager.getAllLayers();
                        const draggedIndex = layers.findIndex(l => l.id === draggedId);
                        const targetIndex = layers.findIndex(l => l.id === targetId);

                        if (draggedIndex !== -1 && targetIndex !== -1) {
                            [layers[draggedIndex], layers[targetIndex]] =
                                [layers[targetIndex], layers[draggedIndex]];
                            layerManager.reorderLayers();
                            renderLayerList();
                        }
                    }
                });

                layerList.appendChild(item);
            });
        }

        function renderPresetButtons() {
            presetGrid.innerHTML = '';
            Object.entries(CONFIG.presetLayers).forEach(([key, config]) => {
                const btn = document.createElement('button');
                btn.className = 'preset-btn';
                btn.textContent = config.name;
                btn.addEventListener('click', () => {
                    layerManager.addLayer(key);
                    renderLayerList();
                });
                presetGrid.appendChild(btn);
            });
        }

        // æ˜¾ç¤ºç¼©æ”¾ / åæ ‡
        function updateMapInfo() {
            const zoom = map.getZoom();
            const center = map.getCenter();
            document.getElementById('zoom-level').textContent = zoom.toFixed(1);
            document.getElementById('coordinates').textContent =
                `${center.lat.toFixed(2)}Â°, ${center.lng.toFixed(2)}Â°`;
        }

        map.on('zoomend moveend', updateMapInfo);
        updateMapInfo();

        resetBtn.addEventListener('click', () => {
            layerManager.reset();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'r' || e.key === 'R') {
                resetBtn.click();
            }
        });

        // åˆå§‹åŒ– UI
        renderLayerList();
        renderPresetButtons();

        // ===== åœ°å›¾é€‰é¡¹é¢æ¿æ”¶èµ·/å±•å¼€ =====
        const viewerEl = document.querySelector('.huaxia-map-viewer');
        const collapseBtn = document.getElementById('controlsCollapseBtn');
        const expandBtn = document.getElementById('controlsExpandBtn');

        if (viewerEl && collapseBtn && expandBtn) {
            // æ”¶èµ·
            collapseBtn.addEventListener('click', function () {
                viewerEl.classList.add('controls-collapsed');
            });

            // å±•å¼€
            expandBtn.addEventListener('click', function () {
                viewerEl.classList.remove('controls-collapsed');
            });

            if (window.innerWidth <= 768) {
                viewerEl.classList.add('controls-collapsed');
            }
        }

    });
    </script>
        <script>
    // åº•éƒ¨å…è´£å£°æ˜ï¼šå¼ºåˆ¶ç­‰å¾… 3 ç§’åæ‰èƒ½å…³é—­ï¼Œå¹¶ç”¨ localStorage è®°ä½æ˜¯å¦å·²é˜…è¯»
    document.addEventListener('DOMContentLoaded', function () {
        const bar = document.getElementById('disclaimerBar');
        if (!bar) return;

        const closeBtn = bar.querySelector('.disclaimer-close-btn');
        const countdownSpan = bar.querySelector('[data-countdown]');

        // æ˜¾ç¤ºæ¡
        bar.style.display = 'block';

        // åˆå§‹ 3 ç§’å€’è®¡æ—¶
        let remaining = 3;
        closeBtn.disabled = true;
        if (countdownSpan) countdownSpan.textContent = remaining;

        const timer = setInterval(() => {
            remaining -= 1;
            if (remaining > 0) {
                if (countdownSpan) countdownSpan.textContent = remaining;
            } else {
                clearInterval(timer);
                // å€’è®¡æ—¶ç»“æŸï¼Œå…è®¸å…³é—­
                if (countdownSpan) countdownSpan.textContent = '';
                closeBtn.disabled = false;
                closeBtn.textContent = 'æˆ‘å·²äº†è§£';
            }
        }, 1000);

        closeBtn.addEventListener('click', () => {
            if (closeBtn.disabled) return;
            bar.classList.add('hide');
            localStorage.setItem(ACK_KEY, '1');
            // åŠ¨ç”»ç»“æŸåç§»é™¤
            setTimeout(() => {
                if (bar && bar.parentNode) {
                    bar.parentNode.removeChild(bar);
                }
            }, 300);
        });
    });
    </script>

</body>
</html>
